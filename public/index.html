<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Private Browser Proxy - No Server Needed</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: white;
            font-size: 18px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .badge {
            background: rgba(255, 255, 255, 0.25);
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }

        .controls {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .url-container {
            flex: 1;
            min-width: 250px;
            position: relative;
        }

        .url-input {
            width: 100%;
            padding: 12px 100px 12px 15px;
            border: none;
            border-radius: 10px;
            background: white;
            font-size: 14px;
            outline: none;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .url-input:focus {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
        }

        .go-btn {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            padding: 8px 20px;
            background: #667eea;
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }

        .go-btn:hover {
            background: #5568d3;
        }

        .mode-select {
            padding: 10px 15px;
            border: none;
            border-radius: 10px;
            background: white;
            font-size: 13px;
            cursor: pointer;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .new-window-btn {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
            backdrop-filter: blur(10px);
        }

        .new-window-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 0;
            overflow: hidden;
        }

        .status {
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            color: white;
            font-size: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .status.error {
            background: rgba(211, 47, 47, 0.9);
        }

        .status.success {
            background: rgba(46, 160, 67, 0.9);
        }

        .status.loading {
            background: rgba(31, 111, 235, 0.9);
        }

        #proxyFrame {
            flex: 1;
            border: none;
            background: white;
        }

        .welcome {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px;
        }

        .welcome-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            text-align: center;
        }

        .welcome-content h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 28px;
        }

        .welcome-content p {
            color: #666;
            line-height: 1.8;
            margin-bottom: 30px;
        }

        .quick-links {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .quick-link {
            padding: 10px 20px;
            background: #f6f8fa;
            border: 1px solid #e1e4e8;
            border-radius: 20px;
            color: #667eea;
            text-decoration: none;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .quick-link:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }

        .info-box {
            background: #f8f9ff;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-top: 20px;
            border-radius: 4px;
            text-align: left;
        }

        .info-box h3 {
            color: #667eea;
            font-size: 14px;
            margin-bottom: 8px;
        }

        .info-box ul {
            color: #666;
            font-size: 13px;
            line-height: 1.6;
            padding-left: 20px;
        }

        @media (max-width: 768px) {
            .controls {
                flex-direction: column;
            }

            .url-container {
                width: 100%;
            }

            .mode-select, .new-window-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>
            üîí Browser Proxy
            <span class="badge">No Server</span>
            <span class="badge">Pure JS</span>
        </h1>
        <div class="controls">
            <div class="url-container">
                <input 
                    type="text" 
                    class="url-input" 
                    id="urlInput" 
                    placeholder="Enter URL (e.g., example.com)"
                    autocomplete="off"
                >
                <button class="go-btn" onclick="loadUrl()">Go</button>
            </div>
            <select class="mode-select" id="modeSelect">
                <option value="iframe">Embedded Mode</option>
                <option value="fetch">Fetch Mode</option>
                <option value="window">New Window</option>
            </select>
            <button class="new-window-btn" onclick="openInNewWindow()">üîó Open Current</button>
        </div>
    </div>

    <div class="status" id="status">
        <span id="statusText">Ready - Enter a URL to browse</span>
    </div>

    <div class="content" id="content">
        <div class="welcome" id="welcome">
            <div class="welcome-content">
                <h2>üåê Pure Browser Proxy</h2>
                <p>
                    This proxy runs <strong>100% in your browser</strong>. No server needed, 
                    no installation, just pure JavaScript. Works completely offline once loaded.
                </p>

                <div class="info-box">
                    <h3>üéØ How to Use:</h3>
                    <ul>
                        <li><strong>Embedded Mode:</strong> Load sites in a frame (some sites may block this)</li>
                        <li><strong>Fetch Mode:</strong> Download and display pages (better compatibility)</li>
                        <li><strong>New Window:</strong> Open in a popup window (most reliable)</li>
                    </ul>
                </div>

                <div class="quick-links">
                    <a class="quick-link" onclick="quickLoad('https://example.com')">Example.com</a>
                    <a class="quick-link" onclick="quickLoad('https://wikipedia.org')">Wikipedia</a>
                    <a class="quick-link" onclick="quickLoad('https://archive.org')">Archive.org</a>
                    <a class="quick-link" onclick="quickLoad('https://github.com')">GitHub</a>
                </div>
            </div>
        </div>
        <iframe id="proxyFrame" style="display: none;"></iframe>
    </div>

    <script>
        const urlInput = document.getElementById('urlInput');
        const proxyFrame = document.getElementById('proxyFrame');
        const modeSelect = document.getElementById('modeSelect');
        const statusDiv = document.getElementById('status');
        const statusText = document.getElementById('statusText');
        const welcome = document.getElementById('welcome');

        let currentUrl = '';

        // CORS proxy options - we'll try them in order
        const CORS_PROXIES = [
            'https://api.allorigins.win/raw?url=',
            'https://corsproxy.io/?',
            'https://api.codetabs.com/v1/proxy?quest=',
            'https://corsproxy.org/?',
        ];

        let currentProxyIndex = 0;

        function updateStatus(message, type = 'info') {
            statusText.textContent = message;
            statusDiv.className = 'status';
            if (type === 'error') statusDiv.classList.add('error');
            else if (type === 'success') statusDiv.classList.add('success');
            else if (type === 'loading') statusDiv.classList.add('loading');
        }

        function normalizeUrl(url) {
            url = url.trim();
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                url = 'https://' + url;
            }
            return url;
        }

        async function loadUrl() {
            const url = normalizeUrl(urlInput.value);
            if (!url) {
                updateStatus('Please enter a URL', 'error');
                return;
            }

            currentUrl = url;
            const mode = modeSelect.value;

            welcome.style.display = 'none';

            if (mode === 'window') {
                openInNewWindow();
                return;
            }

            if (mode === 'iframe') {
                loadInIframe(url);
            } else if (mode === 'fetch') {
                await loadWithFetch(url);
            }
        }

        function loadInIframe(url) {
            updateStatus(`Loading ${url}...`, 'loading');
            proxyFrame.style.display = 'block';
            
            const proxiedUrl = CORS_PROXIES[currentProxyIndex] + encodeURIComponent(url);
            proxyFrame.src = proxiedUrl;

            const timeout = setTimeout(() => {
                updateStatus(`Still loading... This site might not work in embedded mode. Try "New Window" mode.`, 'loading');
            }, 5000);

            proxyFrame.onload = () => {
                clearTimeout(timeout);
                updateStatus(`‚úì Loaded: ${url}`, 'success');
            };

            proxyFrame.onerror = () => {
                clearTimeout(timeout);
                currentProxyIndex = (currentProxyIndex + 1) % CORS_PROXIES.length;
                updateStatus(`Failed to load. Try switching modes or use "New Window".`, 'error');
            };
        }

        async function loadWithFetch(url) {
            updateStatus(`Fetching ${url}...`, 'loading');
            proxyFrame.style.display = 'block';

            let lastError = null;
            let success = false;

            // Try each proxy
            for (let i = 0; i < CORS_PROXIES.length; i++) {
                const proxy = CORS_PROXIES[i];
                try {
                    updateStatus(`Trying proxy ${i + 1}/${CORS_PROXIES.length}...`, 'loading');
                    
                    const response = await fetch(proxy + encodeURIComponent(url), {
                        method: 'GET',
                        mode: 'cors',
                    });

                    if (response.ok) {
                        const html = await response.text();
                        
                        // Create a blob URL to display the content
                        const blob = new Blob([html], { type: 'text/html' });
                        const blobUrl = URL.createObjectURL(blob);
                        
                        proxyFrame.src = blobUrl;
                        updateStatus(`‚úì Loaded: ${url}`, 'success');
                        success = true;
                        break;
                    }
                } catch (error) {
                    lastError = error;
                    console.log(`Proxy ${i + 1} failed:`, error.message);
                }
            }

            if (!success) {
                updateStatus(`‚ùå All proxies failed. Try "New Window" mode or a different site.`, 'error');
                
                // Offer to open in new window
                setTimeout(() => {
                    if (confirm('Unable to load in proxy mode. Open in new window instead?')) {
                        openInNewWindow();
                    }
                }, 1000);
            }
        }

        function openInNewWindow() {
            const url = currentUrl || normalizeUrl(urlInput.value);
            if (!url) {
                updateStatus('Please enter a URL first', 'error');
                return;
            }

            // Try multiple proxies
            const proxy = CORS_PROXIES[currentProxyIndex];
            const proxiedUrl = proxy + encodeURIComponent(url);
            
            const newWindow = window.open(proxiedUrl, '_blank', 'width=1200,height=800,menubar=yes,toolbar=yes,location=yes');
            
            if (newWindow) {
                updateStatus(`‚úì Opened ${url} in new window`, 'success');
                currentProxyIndex = (currentProxyIndex + 1) % CORS_PROXIES.length;
            } else {
                updateStatus('‚ùå Popup blocked. Please allow popups for this page.', 'error');
            }
        }

        function quickLoad(url) {
            urlInput.value = url;
            loadUrl();
        }

        // Enter key support
        urlInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                loadUrl();
            }
        });

        // Focus on load
        window.onload = () => {
            urlInput.focus();
        };
    </script>
</body>
</html>
